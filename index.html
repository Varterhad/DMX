<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>DMX –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    
    <!-- PWA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="DMX Calc">
    
    <style>
        /* –í–ê–® –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ô CSS –ö–û–î –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #000000;
            color: #ffffff;
            line-height: 1.4;
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }
        
        button {
            font-family: inherit;
            cursor: pointer;
            outline: none;
            border: none;
        }
        
        input {
            font-family: inherit;
        }
        
        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
        .app-container {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 20px;
            min-height: 100vh;
        }
        
        /* –ó–ê–ì–û–õ–û–í–û–ö –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø */
        .equipment-header {
            background-color: #333333;
            height: 52px;
            padding: 8px 16px;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .equipment-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            font-weight: bold;
            text-align: left;
            flex: 1;
            height: 100%;
            cursor: pointer;
            padding: 0;
        }
        
        /* –ó–ê–ö–†–ï–ü–õ–ï–ù–ù–û–ï –û–ë–û–†–£–î–û–í–ê–ù–ò–ï */
        .pinned-container {
            background-color: #222222;
            padding: 8px 16px;
            display: none;
        }
        
        .pinned-item {
            background-color: #333333;
            border-radius: 4px;
            padding: 6px 8px;
            margin-top: 4px;
            display: flex;
            align-items: center;
            height: 32px;
        }
        
        .pinned-item-text {
            flex: 1;
            font-size: 12px;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .unpin-btn {
            background: none;
            border: none;
            color: #FF5555;
            font-size: 14px;
            font-weight: bold;
            padding: 0 10px;
            cursor: pointer;
        }
        
        /* –°–ï–ö–¶–ò–Ø –ê–î–†–ï–°–ê */
        .address-section {
            padding: 16px 8px 0 8px;
        }
        
        .address-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .round-btn {
            width: 56px;
            height: 56px;
            border-radius: 8px;
            border: none;
            background-color: #666666;
            color: white;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .address-display {
            flex: 1;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4CAF50;
            font-size: 32px;
            font-weight: bold;
            text-align: center;
        }
        
        .surrounding-addresses {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 12px 16px 0 16px;
            gap: 8px;
        }
        
        .address-group {
            flex: 1;
            display: flex;
            gap: 8px;
        }
        
        .address-group span {
            flex: 1;
            text-align: center;
            color: #AAAAAA;
            font-size: 12px;
            min-width: 30px;
        }
        
        .arrows {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .arrow {
            color: #666666;
            font-size: 14px;
        }
        
        .empty-space {
            width: 40px;
            height: 28px;
        }
        
        /* –°–ï–ö–¶–ò–Ø –í–í–û–î–ê */
        .input-section {
            margin: 16px 0;
            padding: 0 16px;
        }
        
        .input-row {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
        }
        
        .input-label {
            color: white;
            font-size: 16px;
            font-weight: bold;
            width: 60px;
            text-align: right;
            padding-right: 8px;
        }
        
        .number-input {
            width: 100px;
            height: 60px;
            background-color: #333333;
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            padding: 12px 8px;
        }
        
        .number-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px #4CAF50;
        }
        
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .divider {
            height: 1px;
            background-color: #444444;
            margin: 16px 16px;
        }
        
        /* –ö–ù–û–ü–ö–ò –ü–ò–ù–û–í */
        .pins-section {
            margin: 0 8px 16px 8px;
        }
        
        .pins-grid {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 8px;
        }
        
        .pin-btn {
            height: 48px;
            border: none;
            border-radius: 6px;
            background-color: #F44336;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .pin-btn.selected {
            background-color: #4CAF50;
        }
        
        /* –†–ï–ó–£–õ–¨–¢–ê–¢ */
        .result-text {
            text-align: center;
            color: #4CAF50;
            font-size: 14px;
            font-weight: bold;
            line-height: 1.6;
            margin-bottom: 16px;
            padding: 0 16px;
            min-height: 40px;
        }
        
        .reset-btn {
            display: block;
            margin: 0 auto;
            height: 40px;
            padding: 0 16px;
            border: none;
            border-radius: 8px;
            background-color: #FF9800;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* –ü–ê–ù–ï–õ–¨ –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø */
        .equipment-panel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #333333;
            z-index: 1000;
            overflow-y: auto;
            display: none;
        }
        
        .equipment-panel-header {
            display: flex;
            justify-content: flex-end;
            padding: 12px 16px;
            position: sticky;
            top: 0;
            background-color: #333333;
            z-index: 10;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            padding: 8px;
        }
        
        .search-input {
            display: block;
            width: calc(100% - 32px);
            margin: 0 16px 8px 16px;
            padding: 10px 12px;
            background-color: #444444;
            border: 1px solid #666666;
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }
        
        .search-input::placeholder {
            color: #888888;
        }
        
        .add-equipment-btn {
            display: block;
            width: calc(100% - 32px);
            margin: 0 16px 8px 16px;
            height: 48px;
            border: 1px solid #4CAF50;
            border-radius: 8px;
            background-color: #222222;
            color: #4CAF50;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .equipment-list-container {
            padding: 0 16px 16px 16px;
        }
        
        .equipment-item {
            background-color: #444444;
            border-radius: 6px;
            padding: 10px 12px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            min-height: 44px;
        }
        
        .equipment-item-text {
            flex: 1;
            color: white;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .edit-btn, .pin-star-btn {
            background: none;
            border: none;
            color: #4CAF50;
            font-size: 14px;
            padding: 0 8px;
            min-width: 40px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .pin-star-btn.pinned {
            color: #FFD700;
        }
        
        /* –î–ò–ê–õ–û–ì–û–í–û–ï –û–ö–ù–û */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }
        
        .dialog {
            background-color: #333333;
            border-radius: 8px;
            width: 100%;
            max-width: 400px;
            padding: 20px;
        }
        
        .dialog h3 {
            color: white;
            margin-bottom: 20px;
            text-align: center;
            font-size: 18px;
        }
        
        .dialog-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .dialog-input {
            padding: 12px;
            background-color: #444444;
            border: 1px solid #666666;
            border-radius: 4px;
            color: white;
            font-size: 14px;
        }
        
        .dialog-input::placeholder {
            color: #888888;
        }
        
        .dialog-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            margin-top: 20px;
        }
        
        .dialog-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            min-width: 70px;
        }
        
        .cancel-btn {
            background-color: #666666;
            color: white;
        }
        
        .delete-btn {
            background-color: #f44336;
            color: white;
            margin-right: auto;
        }
        
        .save-btn {
            background-color: #4CAF50;
            color: white;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –î–õ–Ø IPHONE */
        @media (max-width: 768px) {
            .pins-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 4px;
            }
            
            .pin-btn {
                height: 60px;
                font-size: 16px;
            }
            
            .address-display {
                font-size: 28px;
                height: 70px;
            }
            
            .round-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .address-group {
                flex-direction: column;
                gap: 4px;
            }
            
            .address-group span {
                font-size: 11px;
            }
        }
        
        /* –ó–ê–ì–†–£–ó–ß–ò–ö */
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }
        
        /* –°–ö–†–û–õ–õ–ë–ê–† */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #222;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <!-- –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (—Å–∫—Ä—ã—Ç–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏) -->
    <div id="instructions" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #000; color: white; padding: 20px; z-index: 9999; overflow-y: auto;">
        <h2>üì± –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</h2>
        <p>–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ iPhone:</p>
        <p>1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" (–∫–≤–∞–¥—Ä–∞—Ç —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π)</p>
        <p>2. –í—ã–±–µ—Ä–∏—Ç–µ "–ù–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª"</p>
        <p>3. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å"</p>
        <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ.</p>
        <button onclick="hideInstructions()" style="margin-top: 20px; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px;">–ü–æ–Ω—è—Ç–Ω–æ</button>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° -->
    <div class="app-container">
        <!-- –ü–∞–Ω–µ–ª—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
        <div class="equipment-header">
            <button class="equipment-toggle" onclick="toggleEquipmentList()">
                –û–ë–û–†–£–î–û–í–ê–ù–ò–ï ‚ñº
            </button>
        </div>

        <!-- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ -->
        <div id="pinned-container" class="pinned-container"></div>

        <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ -->
        <div class="address-section">
            <div class="address-controls">
                <button class="round-btn minus-btn" onclick="changeAddress(-1)">-</button>
                <div id="address-display" class="address-display">1</div>
                <button class="round-btn plus-btn" onclick="changeAddress(1)">+</button>
            </div>

            <div class="surrounding-addresses">
                <div class="address-group" id="prev-addresses"></div>
                <div class="arrows">
                    <span class="arrow">‚Üê</span>
                    <div class="empty-space"></div>
                    <span class="arrow">‚Üí</span>
                </div>
                <div class="address-group" id="next-addresses"></div>
            </div>
        </div>

        <!-- –í–≤–æ–¥ —à–∞–≥–∞ –∏ –∞–¥—Ä–µ—Å–∞ -->
        <div class="input-section">
            <div class="input-row">
                <span class="input-label">–®–ê–ì:</span>
                <input type="number" id="step-input" class="number-input" value="1" min="1" max="512" onchange="updateStepValue()">
            </div>
            <div class="input-row">
                <span class="input-label">–ê–î–†–ï–°:</span>
                <input type="number" id="address-input" class="number-input" value="1" min="1" max="512" onchange="setPinsFromAddress()">
            </div>
        </div>

        <div class="divider"></div>

        <!-- –ö–Ω–æ–ø–∫–∏ –ø–∏–Ω–æ–≤ -->
        <div class="pins-section">
            <div class="pins-grid" id="pins-container"></div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
        <div id="result-text" class="result-text">
            –ê–¥—Ä–µ—Å: 1<br>–ü–∏–Ω—ã: –Ω–µ—Ç
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ -->
        <button class="reset-btn" onclick="resetAll()">–°–ë–†–û–°–ò–¢–¨ –í–°–ï</button>

        <!-- –ü–∞–Ω–µ–ª—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (—Å–∫—Ä—ã—Ç–∞—è) -->
        <div id="equipment-panel" class="equipment-panel">
            <div class="equipment-panel-header">
                <button class="close-btn" onclick="toggleEquipmentList()">
                    ‚úï –ó–ê–ö–†–´–¢–¨
                </button>
            </div>

            <input type="text" id="equipment-search" class="search-input" 
                   placeholder="–ü–æ–∏—Å–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è..." oninput="filterEquipment(this.value)">

            <button class="add-equipment-btn" onclick="showAddEquipmentDialog()">
                + –î–û–ë–ê–í–ò–¢–¨ –ü–†–ò–ë–û–†
            </button>

            <div class="equipment-list-container" id="equipment-list-container">
                <!-- –°–ø–∏—Å–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>

    <!-- –î–∏–∞–ª–æ–≥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
    <div id="equipment-dialog" class="dialog-overlay">
        <div class="dialog">
            <h3 id="dialog-title">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–±–æ—Ä</h3>
            <div class="dialog-content">
                <input type="text" id="dialog-name" class="dialog-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–±–æ—Ä–∞">
                <input type="text" id="dialog-power" class="dialog-input" placeholder="–ú–æ—â–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1000W, 500W, DIM)">
                <input type="text" id="dialog-channels" class="dialog-input" placeholder="DMX –∫–∞–Ω–∞–ª—ã (—á–µ—Ä–µ–∑ /, –Ω–∞–ø—Ä–∏–º–µ—Ä: 16/20 –∏–ª–∏ DIM)">
            </div>
            <div class="dialog-buttons">
                <button class="dialog-btn cancel-btn" onclick="closeEquipmentDialog()">–û—Ç–º–µ–Ω–∞</button>
                <button class="dialog-btn delete-btn" id="delete-btn" style="display: none;" onclick="deleteEquipment()">–£–¥–∞–ª–∏—Ç—å</button>
                <button class="dialog-btn save-btn" onclick="saveEquipment()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let currentStep = 1;
        let currentAddress = 1;
        let pinSelected = [false, false, false, false, false, false, false, false, false];
        let allEquipment = [];
        let pinnedEquipment = [];
        let editingEquipment = null;
        const DMX_TOTAL_CHANNELS = 512;

        // –ö–õ–ê–°–° –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø
        class EquipmentItem {
            constructor(name, power, channels, pinned = false, isCustom = false) {
                this.name = name;
                this.power = power;
                this.channels = channels;
                this.pinned = pinned;
                this.isCustom = isCustom;
            }

            toString() {
                return `${this.name} ${this.power} ${this.channels}ch`;
            }

            toStorageString() {
                return `${this.name}||${this.power}||${this.channels}||${this.pinned}||${this.isCustom}`;
            }

            static fromStorageString(storageString) {
                const parts = storageString.split('||');
                if (parts.length === 5) {
                    return new EquipmentItem(
                        parts[0],
                        parts[1],
                        parts[2],
                        parts[3] === 'true',
                        parts[4] === 'true'
                    );
                }
                return null;
            }
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø
        function initializeEquipment() {
            // Clay Paky
            allEquipment.push(new EquipmentItem("Clay Paky Scenius Unico", "1800W", "40/44"));
            allEquipment.push(new EquipmentItem("Clay Paky Alfa Spot HPE 1500", "2000W", "36/40"));
            allEquipment.push(new EquipmentItem("Clay Paky Alfa Profile QWO 800", "1200W", "32/36"));
            allEquipment.push(new EquipmentItem("Clay Paky Sharpy", "350W", "16/20"));
            allEquipment.push(new EquipmentItem("Clay Paky Sharpy Wash 330", "550W", "19/22"));
            allEquipment.push(new EquipmentItem("Clay Paky Super Sharpy", "700W", "24/28"));
            allEquipment.push(new EquipmentItem("Clay Paky Mythos", "700W", "30/34"));
            allEquipment.push(new EquipmentItem("Clay Paky A.LEDA B-EYE K20", "850W", "21/35/111/148"));
            allEquipment.push(new EquipmentItem("Clay Paky Stormy CC", "850W", "7/10/14"));

            // Martin
            allEquipment.push(new EquipmentItem("Martin Mac2000 Wash", "1500W", "19/21"));
            allEquipment.push(new EquipmentItem("Martin Mac2000 Performance", "1500W", "28/31"));
            allEquipment.push(new EquipmentItem("Martin Mac2000 Profile", "1500W", "20/24"));
            allEquipment.push(new EquipmentItem("Martin Mac600", "750W", "10/12/14"));
            allEquipment.push(new EquipmentItem("Martin Mac550", "600W", "21/27"));
            allEquipment.push(new EquipmentItem("Martin Mac101", "123W", "8/12"));
            allEquipment.push(new EquipmentItem("Martin Mac Viper Performance", "1350W", "32/40"));
            allEquipment.push(new EquipmentItem("Martin Mac Quantum", "1020W", "17/33"));
            allEquipment.push(new EquipmentItem("Martin Mac Aura XB", "400W", "14/25"));
            allEquipment.push(new EquipmentItem("Martin Atomic 3000", "27–ê", "1/3/4"));

            // JBLighting
            allEquipment.push(new EquipmentItem("JBLighting A 7", "350W", "13/15/16/19"));
            allEquipment.push(new EquipmentItem("JBLighting A 12", "995W", "15/19/18/22/38"));

            // GLP
            allEquipment.push(new EquipmentItem("GLP IMPRESSION", "350W", "10/13/14"));

            // SHOW SOLUTIONS
            allEquipment.push(new EquipmentItem("SHOW SOLUTIONS V-2033", "4200W", "12"));

            // DIA Lighting
            allEquipment.push(new EquipmentItem("DIA Lighting LED BAR 48 RGBW", "100W", "3/4/5/6/11"));
            allEquipment.push(new EquipmentItem("DIA Lighting LED Battery Wash Beam", "95W", "5/9/12"));
            allEquipment.push(new EquipmentItem("SlimPro 18 QuadColor RGBW", "150W", "4/6/9"));
            allEquipment.push(new EquipmentItem("DIA Lighting IS200", "350W", "16"));

            // SGM
            allEquipment.push(new EquipmentItem("SGM G-spot", "1100W", "24/30"));
            allEquipment.push(new EquipmentItem("SGM P2", "200W", "3/6/9/12/15/22"));
            allEquipment.push(new EquipmentItem("SGM P5", "450W", "3/4/6/8/9/10"));
            allEquipment.push(new EquipmentItem("SGM Q7", "465W", "3/4/6/8"));
            allEquipment.push(new EquipmentItem("SGM XC-5 Color LED strobe", "360W", "1/2/3/4/6/7"));

            // THOMAS
            allEquipment.push(new EquipmentItem("THOMAS PixelLine 1044", "164W", "3/4/10/54/61"));
            allEquipment.push(new EquipmentItem("THOMAS Blinder 2 DIM", "1300W", "1"));
            allEquipment.push(new EquipmentItem("THOMAS Blinder 4 DIM", "2600W", "1"));
            allEquipment.push(new EquipmentItem("THOMAS Blinder 8 DIM", "5200W", "1"));

            // RGB Lines
            allEquipment.push(new EquipmentItem("RGB Line350", "50W", "0"));
            allEquipment.push(new EquipmentItem("RGB Line1000", "150W", "0"));

            // ShowTec
            allEquipment.push(new EquipmentItem("ShowTec EventSpot 1900", "45W", "3/4/5/10"));
            allEquipment.push(new EquipmentItem("ShowTec Blinder 2DMX", "1300W", "1"));
            allEquipment.push(new EquipmentItem("ShowTec Blinder 4DMX", "2600W", "2"));
            allEquipment.push(new EquipmentItem("ShowTec Blinder 8DMX", "5200W", "4"));
            allEquipment.push(new EquipmentItem("ShowTec Matrix 5*5 Blinder", "1900W", "4/9/25/29"));
            allEquipment.push(new EquipmentItem("ShowTec Sunstrip Active", "800W", "1/2/5/10"));
            allEquipment.push(new EquipmentItem("ShowTec Cobra Strip", "500W", "1/2/5/10"));

            // BRITEQ
            allEquipment.push(new EquipmentItem("BRITEQ POWERMATRIX 5*5-RGB Mk2", "750W", "4/5/6/11/25/75/81/100/106/125/131"));
            allEquipment.push(new EquipmentItem("BRITEQ BT-VINTAGE", "980W", "5/6/7"));

            // LL
            allEquipment.push(new EquipmentItem("LL Stage Beam 6 Led", "55W", "6"));

            // AMERICAN DJ
            allEquipment.push(new EquipmentItem("AMERICAN DJ REVO III LED", "50W", "4/10"));

            // ETC
            allEquipment.push(new EquipmentItem("ETC Sours Four 26", "575W", "DIM"));
            allEquipment.push(new EquipmentItem("ETC Sours Four JR 36", "575W", "DIM"));
            allEquipment.push(new EquipmentItem("ETC Sours Four Zoom 15-30", "575W", "DIM"));
            allEquipment.push(new EquipmentItem("ETC Sours Four Zoom 25-50", "750W", "DIM"));

            // Arri
            allEquipment.push(new EquipmentItem("Arri Studio 2000", "2000W", "DIM"));

            // PAR Fixtures
            allEquipment.push(new EquipmentItem("Par 16", "50W", "DIM"));
            allEquipment.push(new EquipmentItem("Par 38", "90W", "DIM"));
            allEquipment.push(new EquipmentItem("Par 56", "300W", "DIM"));
            allEquipment.push(new EquipmentItem("Par 64", "1000W", "DIM"));
            allEquipment.push(new EquipmentItem("Bar 6 *Par 64", "6000W", "DIM"));

            // EUROLITE
            allEquipment.push(new EquipmentItem("EUROLITE LED Par-56 floor36", "16W", "5"));
            allEquipment.push(new EquipmentItem("EUROLITE LED Par-64 spot36", "32W", "6"));

            // COEMAR
            allEquipment.push(new EquipmentItem("COEMAR PAR Lite LED Silver", "55W", "6"));
            allEquipment.push(new EquipmentItem("COEMAR PIN Lite LED Silver", "54W", "6"));
            allEquipment.push(new EquipmentItem("COEMAR PANORAMA CYC POWER", "575W", "6"));

            // GRIVEN
            allEquipment.push(new EquipmentItem("GRIVEN KALEIDO", "650W", "5"));
            allEquipment.push(new EquipmentItem("GRIVEN KOLORADO", "2800W", "5"));

            // Desisti
            allEquipment.push(new EquipmentItem("Desisti softlight 3111", "2000W", "0"));

            // Studio Due
            allEquipment.push(new EquipmentItem("Studio Due space flower", "3000W", "0"));
            allEquipment.push(new EquipmentItem("Studio Due C34", "1100W", "13/15/20"));

            // Sky
            allEquipment.push(new EquipmentItem("Sky Rose 4000w", "4100W", "0"));
            allEquipment.push(new EquipmentItem("Light Sky ip3000", "628W", "20/24"));
            allEquipment.push(new EquipmentItem("Light Sky TX1810 Zoom", "246W", "10/16/20/24"));

            // Color imagination
            allEquipment.push(new EquipmentItem("Color imagination Si-171 minispot 250 Z", "290W", "14/16/18"));

            // Robert Juliat
            allEquipment.push(new EquipmentItem("Robert Juliat Aramis", "2500W", "0"));
            allEquipment.push(new EquipmentItem("Robert Juliat Viktor", "1800W", "0"));
            allEquipment.push(new EquipmentItem("Robert Juliat Flo", "1800W", "0"));

            // LDR
            allEquipment.push(new EquipmentItem("LDR Canto 1200", "1200W", "0"));
            allEquipment.push(new EquipmentItem("LDR Canto 2000FF", "2000W", "0"));

            // Fog/Haze Machines
            allEquipment.push(new EquipmentItem("TourHazer", "1600W", "2"));
            allEquipment.push(new EquipmentItem("DF-50", "437W", "1"));
            allEquipment.push(new EquipmentItem("JEM TECHNOHAZE", "600W", "–ü—É–ª—å—Ç –î–£"));
            allEquipment.push(new EquipmentItem("JEM TECHNOFOG", "750W", "–ü—É–ª—å—Ç –î–£"));
            allEquipment.push(new EquipmentItem("ZR 33", "1500W", "1"));
            allEquipment.push(new EquipmentItem("MDG ATMOSPHERE APS H.O.", "1415W", "2"));
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ù–¢–ï–†–§–ï–ô–°–ê
        function initializeUI() {
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø–∏–Ω–æ–≤
            const pinsContainer = document.getElementById('pins-container');
            for (let i = 0; i < 9; i++) {
                const button = document.createElement('button');
                button.className = 'pin-btn';
                button.textContent = (i + 1).toString();
                button.dataset.index = i;
                button.addEventListener('click', () => togglePin(i));
                pinsContainer.appendChild(button);
            }

            updateSurroundingAddresses();
            updateEquipmentList();
            updatePinnedList();
        }

        // –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –ê–î–†–ï–°–ê (1-512)
        function normalizeAddress(address) {
            if (address < 1) {
                // –ï—Å–ª–∏ –∞–¥—Ä–µ—Å –º–µ–Ω—å—à–µ 1, –∏–¥–µ–º —Å –∫–æ–Ω—Ü–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
                while (address < 1) {
                    address += DMX_TOTAL_CHANNELS;
                }
            }
            // –ü—Ä–∏–≤–æ–¥–∏–º –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É 1-512
            let result = ((address - 1) % DMX_TOTAL_CHANNELS) + 1;
            return result;
        }

        // –ò–ó–ú–ï–ù–ï–ù–ò–ï –ê–î–†–ï–°–ê (–æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ + –∏ -)
        function changeAddress(direction) {
            // direction = 1 –¥–ª—è +, -1 –¥–ª—è -
            const step = parseInt(document.getElementById('step-input').value) || 1;
            let newAddress = currentAddress + (direction * step);
            
            console.log("–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞:", {
                currentAddress,
                step,
                direction,
                newAddressBefore: newAddress,
                newAddressAfter: normalizeAddress(newAddress)
            });
            
            currentAddress = normalizeAddress(newAddress);
            updateUI();
        }

        // –£–í–ï–õ–ò–ß–ï–ù–ò–ï –ê–î–†–ï–°–ê (—Å—Ç–∞—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
        function increaseAddress() {
            changeAddress(1);
        }

        // –£–ú–ï–ù–¨–®–ï–ù–ò–ï –ê–î–†–ï–°–ê (—Å—Ç–∞—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
        function decreaseAddress() {
            changeAddress(-1);
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –®–ê–ì–ê
        function updateStepValue() {
            const stepInput = document.getElementById('step-input');
            let step = parseInt(stepInput.value) || 1;
            
            if (step < 1) {
                step = 1;
                stepInput.value = "1";
            } else if (step > 512) {
                step = step % DMX_TOTAL_CHANNELS;
                if (step === 0) step = DMX_TOTAL_CHANNELS;
                stepInput.value = step.toString();
            }
            
            currentStep = step;
            updateSurroundingAddresses();
        }

        // –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ü–ò–ù–ê
        function togglePin(index) {
            pinSelected[index] = !pinSelected[index];
            updateResult();
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–ê
        function updateResult() {
            let addr = 0;
            for (let i = 0; i < 9; i++) {
                if (pinSelected[i]) {
                    addr += Math.pow(2, i);
                }
            }

            addr = normalizeAddress(addr);
            currentAddress = addr;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            document.getElementById('address-display').textContent = addr;
            document.getElementById('address-input').value = addr;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø–∏–Ω–æ–≤
            const pinButtons = document.querySelectorAll('.pin-btn');
            pinButtons.forEach((btn, i) => {
                btn.classList.toggle('selected', pinSelected[i]);
            });

            // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø–∏–Ω–æ–≤
            let pinsText = "–ü–∏–Ω—ã: ";
            const selectedPins = [];
            for (let i = 0; i < 9; i++) {
                if (pinSelected[i]) {
                    selectedPins.push(i + 1);
                }
            }
            pinsText += selectedPins.length > 0 ? selectedPins.join(',') : '–Ω–µ—Ç';

            document.getElementById('result-text').innerHTML = `–ê–¥—Ä–µ—Å: ${addr}<br>${pinsText}`;
            
            updateSurroundingAddresses();
        }

        // –£–°–¢–ê–ù–û–í–ö–ê –ü–ò–ù–û–í –ò–ó –ê–î–†–ï–°–ê
        function setPinsFromAddress() {
            const addressInput = document.getElementById('address-input');
            let addr = parseInt(addressInput.value) || 1;
            
            addr = normalizeAddress(addr);
            currentAddress = addr;
            addressInput.value = addr;
            document.getElementById('address-display').textContent = addr;

            // –°–±—Ä–æ—Å –ø–∏–Ω–æ–≤
            pinSelected = [false, false, false, false, false, false, false, false, false];

            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∏–Ω–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–¥—Ä–µ—Å–∞
            for (let i = 0; i < 9; i++) {
                const bit = Math.pow(2, i);
                if ((addr & bit) !== 0) {
                    pinSelected[i] = true;
                }
            }

            updateResult();
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–û–°–ï–î–ù–ò–• –ê–î–†–ï–°–û–í
        function updateSurroundingAddresses() {
            const prevContainer = document.getElementById('prev-addresses');
            const nextContainer = document.getElementById('next-addresses');
            
            prevContainer.innerHTML = '';
            nextContainer.innerHTML = '';

            // –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∞–¥—Ä–µ—Å–∞
            for (let i = 0; i < 3; i++) {
                const stepsBack = (3 - i) * currentStep;
                const prevAddress = normalizeAddress(currentAddress - stepsBack);
                const span = document.createElement('span');
                span.textContent = prevAddress;
                prevContainer.appendChild(span);
            }

            // –°–ª–µ–¥—É—é—â–∏–µ –∞–¥—Ä–µ—Å–∞
            for (let i = 0; i < 3; i++) {
                const stepsForward = (i + 1) * currentStep;
                const nextAddress = normalizeAddress(currentAddress + stepsForward);
                const span = document.createElement('span');
                span.textContent = nextAddress;
                nextContainer.appendChild(span);
            }
        }

        // –°–ë–†–û–° –í–°–ï–ì–û
        function resetAll() {
            currentStep = 1;
            currentAddress = 1;
            pinSelected = [false, false, false, false, false, false, false, false, false];
            
            document.getElementById('step-input').value = "1";
            document.getElementById('address-input').value = "1";
            
            updateUI();
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–°–ï–ì–û UI
        function updateUI() {
            document.getElementById('address-display').textContent = currentAddress;
            document.getElementById('address-input').value = currentAddress;
            updateResult();
            updateSurroundingAddresses();
            saveToStorage();
        }

        // –†–ê–ë–û–¢–ê –° –û–ë–û–†–£–î–û–í–ê–ù–ò–ï–ú
        function toggleEquipmentList() {
            const panel = document.getElementById('equipment-panel');
            const toggleBtn = document.querySelector('.equipment-toggle');
            
            if (panel.style.display === 'block') {
                panel.style.display = 'none';
                toggleBtn.textContent = '–û–ë–û–†–£–î–û–í–ê–ù–ò–ï ‚ñº';
                document.getElementById('equipment-search').value = '';
            } else {
                panel.style.display = 'block';
                toggleBtn.textContent = '–û–ë–û–†–£–î–û–í–ê–ù–ò–ï ‚ñ≤';
                updateEquipmentList();
            }
        }

        function updateEquipmentList() {
            const container = document.getElementById('equipment-list-container');
            const searchTerm = document.getElementById('equipment-search').value.toLowerCase();
            
            container.innerHTML = '';
            
            allEquipment.forEach((item, index) => {
                if (searchTerm && !item.name.toLowerCase().includes(searchTerm) &&
                    !item.power.toLowerCase().includes(searchTerm) &&
                    !item.channels.toLowerCase().includes(searchTerm)) {
                    return;
                }
                
                const itemDiv = document.createElement('div');
                itemDiv.className = 'equipment-item';
                
                const textDiv = document.createElement('div');
                textDiv.className = 'equipment-item-text';
                textDiv.textContent = item.toString();
                
                const editBtn = document.createElement('button');
                editBtn.className = 'edit-btn';
                editBtn.textContent = '‚úé';
                editBtn.onclick = () => showEditEquipmentDialog(item);
                
                const pinBtn = document.createElement('button');
                pinBtn.className = `pin-star-btn ${item.pinned ? 'pinned' : ''}`;
                pinBtn.textContent = item.pinned ? '‚òÖ' : '‚òÜ';
                pinBtn.onclick = () => togglePinEquipment(item);
                
                itemDiv.appendChild(textDiv);
                itemDiv.appendChild(editBtn);
                itemDiv.appendChild(pinBtn);
                container.appendChild(itemDiv);
            });
        }

        function updatePinnedList() {
            const container = document.getElementById('pinned-container');
            container.innerHTML = '';
            
            pinnedEquipment = allEquipment.filter(item => item.pinned);
            
            if (pinnedEquipment.length === 0) {
                container.style.display = 'none';
                return;
            }
            
            container.style.display = 'block';
            
            pinnedEquipment.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'pinned-item';
                
                const textDiv = document.createElement('div');
                textDiv.className = 'pinned-item-text';
                textDiv.textContent = `${item.name} - ${item.power}, ${item.channels}ch`;
                
                const unpinBtn = document.createElement('button');
                unpinBtn.className = 'unpin-btn';
                unpinBtn.textContent = '‚úï';
                unpinBtn.onclick = () => togglePinEquipment(item);
                
                itemDiv.appendChild(textDiv);
                itemDiv.appendChild(unpinBtn);
                container.appendChild(itemDiv);
            });
        }

        function filterEquipment(searchTerm) {
            updateEquipmentList();
        }

        function showAddEquipmentDialog() {
            editingEquipment = null;
            document.getElementById('dialog-title').textContent = '–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–±–æ—Ä';
            document.getElementById('delete-btn').style.display = 'none';
            document.getElementById('dialog-name').value = '';
            document.getElementById('dialog-power').value = '';
            document.getElementById('dialog-channels').value = '';
            document.getElementById('equipment-dialog').style.display = 'flex';
            
            setTimeout(() => {
                document.getElementById('dialog-name').focus();
            }, 100);
        }

        function showEditEquipmentDialog(item) {
            editingEquipment = item;
            document.getElementById('dialog-title').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–±–æ—Ä';
            document.getElementById('delete-btn').style.display = item.isCustom ? 'block' : 'none';
            document.getElementById('dialog-name').value = item.name;
            document.getElementById('dialog-power').value = item.power;
            document.getElementById('dialog-channels').value = item.channels;
            document.getElementById('equipment-dialog').style.display = 'flex';
            
            setTimeout(() => {
                document.getElementById('dialog-name').focus();
            }, 100);
        }

        function closeEquipmentDialog() {
            document.getElementById('equipment-dialog').style.display = 'none';
        }

        function saveEquipment() {
            const name = document.getElementById('dialog-name').value.trim();
            const power = document.getElementById('dialog-power').value.trim();
            const channels = document.getElementById('dialog-channels').value.trim();
            
            if (!name || !power || !channels) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (editingEquipment) {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
                editingEquipment.name = name;
                editingEquipment.power = power;
                editingEquipment.channels = channels;
                if (!editingEquipment.isCustom) {
                    editingEquipment.isCustom = true;
                }
            } else {
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
                const newItem = new EquipmentItem(name, power, channels, false, true);
                allEquipment.push(newItem);
            }
            
            saveToStorage();
            updateEquipmentList();
            updatePinnedList();
            closeEquipmentDialog();
        }

        function deleteEquipment() {
            if (!editingEquipment || !editingEquipment.isCustom) return;
            
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–±–æ—Ä "${editingEquipment.name}"?`)) {
                return;
            }
            
            const index = allEquipment.indexOf(editingEquipment);
            if (index > -1) {
                allEquipment.splice(index, 1);
            }
            
            saveToStorage();
            updateEquipmentList();
            updatePinnedList();
            closeEquipmentDialog();
        }

        function togglePinEquipment(item) {
            item.pinned = !item.pinned;
            
            saveToStorage();
            updateEquipmentList();
            updatePinnedList();
        }

        // –†–ê–ë–û–¢–ê –° –õ–û–ö–ê–õ–¨–ù–´–ú –•–†–ê–ù–ò–õ–ò–©–ï–ú
        function saveToStorage() {
            try {
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
                const customItems = allEquipment.filter(item => item.isCustom);
                const customData = customItems.map(item => item.toStorageString());
                localStorage.setItem('dmx_custom_equipment', JSON.stringify(customData));
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
                const pinnedData = allEquipment.filter(item => item.pinned).map(item => item.toStorageString());
                localStorage.setItem('dmx_pinned_equipment', JSON.stringify(pinnedData));
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
                const settings = {
                    step: currentStep,
                    address: currentAddress,
                    pins: pinSelected
                };
                localStorage.setItem('dmx_settings', JSON.stringify(settings));
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', e);
            }
        }

        function loadFromStorage() {
            try {
                // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
                const customData = JSON.parse(localStorage.getItem('dmx_custom_equipment') || '[]');
                customData.forEach(storageString => {
                    const item = EquipmentItem.fromStorageString(storageString);
                    if (item) {
                        allEquipment.push(item);
                    }
                });
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
                const pinnedData = JSON.parse(localStorage.getItem('dmx_pinned_equipment') || '[]');
                pinnedData.forEach(storageString => {
                    const savedItem = EquipmentItem.fromStorageString(storageString);
                    if (savedItem) {
                        // –ü–æ–∏—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ø–∏—Å–∫–µ
                        const existingItem = allEquipment.find(item => 
                            item.name === savedItem.name &&
                            item.power === savedItem.power &&
                            item.channels === savedItem.channels
                        );
                        
                        if (existingItem) {
                            existingItem.pinned = true;
                        } else if (savedItem.isCustom) {
                            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–∏–±–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ
                            savedItem.pinned = true;
                            allEquipment.push(savedItem);
                        }
                    }
                });
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
                const settings = JSON.parse(localStorage.getItem('dmx_settings') || '{}');
                if (settings.step) {
                    currentStep = settings.step;
                    document.getElementById('step-input').value = settings.step;
                }
                if (settings.address) {
                    currentAddress = settings.address;
                    document.getElementById('address-input').value = settings.address;
                }
                if (settings.pins) {
                    pinSelected = settings.pins;
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', e);
            }
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        document.addEventListener('DOMContentLoaded', () => {
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
            if (!localStorage.getItem('dmx_first_visit')) {
                document.getElementById('instructions').style.display = 'block';
                localStorage.setItem('dmx_first_visit', 'true');
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            initializeEquipment();
            loadFromStorage();
            initializeUI();
            updateUI();
            
            // –°–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            window.addEventListener('beforeunload', saveToStorage);
            
            // PWA: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').catch(console.error);
            }
            
            console.log('DMX Calculator initialized');
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const dialog = document.getElementById('equipment-dialog');
                if (dialog.style.display === 'flex') {
                    closeEquipmentDialog();
                }
            }
            
            if (e.key === 'Enter' && document.getElementById('equipment-dialog').style.display === 'flex') {
                const active = document.activeElement;
                if (active && (active.id === 'dialog-name' || active.id === 'dialog-power' || active.id === 'dialog-channels')) {
                    e.preventDefault();
                    if (active.id === 'dialog-name') {
                        document.getElementById('dialog-power').focus();
                    } else if (active.id === 'dialog-power') {
                        document.getElementById('dialog-channels').focus();
                    } else if (active.id === 'dialog-channels') {
                        saveEquipment();
                    }
                }
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
        window.hideInstructions = function() {
            document.getElementById('instructions').style.display = 'none';
        };
    </script>
</body>
</html>
